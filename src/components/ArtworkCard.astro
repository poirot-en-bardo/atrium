---
import type { Artist } from '../types/gallery';
import { withBase } from '../utils/withBase';

interface Props {
  id: string;
  title: string;
  artist: Artist;
  imageUrl: string;
  year?: string;
  description?: string;
  price?: string;
  sold?: boolean;
  forSale?: boolean;
}

const { id, title, artist, imageUrl, year, description, price, sold, forSale } = Astro.props;
const resolvedImage = withBase(imageUrl);

const displayPrice = price || (forSale ? 'Preț la cerere' : null);
const isSold = sold || price === 'VÂNDUT';
---

<article
  class="artwork-card"
  data-artwork-id={id}
  data-for-sale={forSale ? 'true' : 'false'}
  data-sold={isSold ? 'true' : 'false'}
  data-price={price || ''}
>
  <div class="artwork-image">
    <img src={resolvedImage} alt={title} loading="lazy" />
    <span class="sold-badge" data-role="sold-badge" aria-hidden={!isSold} hidden={!isSold}>
      VÂNDUT
    </span>
  </div>
  <div class="artwork-meta">
    <h3 class="artwork-title">{title}</h3>
    <p class="artwork-author">
      <a class="artist-link" href={`artist/${artist.id}/`}>{artist.name}</a>
    </p>
    {year ? <p class="artwork-year">{year}</p> : null}
    {description ? <p class="artwork-description">{description}</p> : null}
    {displayPrice && (
      <p class={`artwork-price ${isSold ? 'is-sold' : ''}`}>
        {displayPrice}
      </p>
    )}
  </div>
</article>
